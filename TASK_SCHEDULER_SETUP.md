# Windowsタスクスケジューラでの自動実行設定

## バッチファイルの動作について

**はい、Windowsタスクスケジューラでバッチファイルは動作します**が、以下の注意点があります。

## タスクスケジューラ設定方法

### 1. 基本設定

1. **タスクスケジューラを開く**
   - `Win + R` → `taskschd.msc`

2. **基本タスクの作成**
   - 「操作」→「基本タスクの作成」
   - 名前: `Twitter Reply Bot Auto Cleanup`
   - 説明: `自動クリーンアップ付きTwitter返信ボット実行`

3. **トリガー設定**
   - 実行頻度を選択（毎日、毎週など）

### 2. 操作設定（重要）

**プログラム/スクリプト**: `cmd.exe`
**引数の追加**: `/c "C:\GenerativeAI\Twitter_reply_02\run_with_cleanup.bat --debug"`
**開始場所**: `C:\GenerativeAI\Twitter_reply_02`

### 3. 条件設定

- ☑ **コンピューターがAC電源に接続されている場合のみタスクを開始する**: チェックを外す
- ☑ **ネットワーク接続が利用可能な場合のみタスクを開始する**: チェック

### 4. 設定

- ☑ **タスクが失敗した場合の再起動の間隔**: `1分`
- ☑ **次の期間後に再起動を停止**: `1時間`
- ☑ **タスクを強制的に停止する**: `2時間`

## 推奨される設定

### オプション1: バッチファイル直接実行

```
プログラム/スクリプト: C:\GenerativeAI\Twitter_reply_02\run_with_cleanup.bat
引数の追加: --debug
開始場所: C:\GenerativeAI\Twitter_reply_02
```

### オプション2: PowerShell経由（推奨）

```
プログラム/スクリプト: powershell.exe
引数の追加: -ExecutionPolicy Bypass -File "C:\GenerativeAI\Twitter_reply_02\run_with_cleanup.ps1"
開始場所: C:\GenerativeAI\Twitter_reply_02
```

### オプション3: Python直接実行（最も確実）

```
プログラム/スクリプト: C:\Users\nyuki\miniconda3\envs\TwitterReplyEnv\python.exe
引数の追加: -m reply_bot.check_login_status --debug
開始場所: C:\GenerativeAI\Twitter_reply_02
```

## トラブルシューティング

### よくある問題と解決策

1. **「開始場所」の設定忘れ**
   - 必ず `C:\GenerativeAI\Twitter_reply_02` を設定

2. **権限不足**
   - タスク作成時に「最高の特権で実行する」にチェック

3. **環境変数の問題**
   - Python環境のフルパスを指定

4. **ユーザーアカウント制御（UAC）**
   - 「ユーザーがログオンしているかどうかに関わらず実行する」を選択

## テスト実行

設定後、右クリック→「実行」でテストしてください。

## ログ確認

- タスクスケジューラ履歴
- アプリケーションログ（イベントビューア）
- プロジェクトフォルダ内の`.log`ファイル

## セキュリティ考慮事項

- タスクスケジューラで実行される際は、ブラウザの表示はされません
- ヘッドレスモードでの実行となります
- ログファイルでの動作確認が重要になります

## おすすめの運用方法

1. **手動テスト**: まずコマンドラインで正常動作を確認
2. **タスクスケジューラテスト**: 手動で「実行」ボタンをクリックしてテスト
3. **定期実行開始**: 問題なければ定期実行を開始

タスクスケジューラでの実行では、バッチファイル内のクリーンアップ処理が特に重要になります。